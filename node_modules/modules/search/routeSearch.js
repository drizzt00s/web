var utility = require('utlity.js');
var user = require("moduleUser");
var fs = require("fs");
var httpUrl = require("url");
var httpQueryString = require("querystring");
var http = require('http');
var crypto = require("crypto");
var im = require("imagemagick");
var dbUtlity = require('dbUtlity.js');
var Error = require('error.js');


exports.searchMain = function(req, res){
	res.render("search/search.ejs",{title:''});
};

exports.autoSearch = function(req, res){
	var userGender = req.body.userGender;
	var searchedGender = '';
	if(userGender === '男'){
		searchedGender = '女';
	} 
	else if(userGender === '女'){
		searchedGender = '男';
	}
	var client = utility.prepareDb();
	var querystring = "select * from d where gender='" + searchedGender +"'";
	client.query(querystring, function(error, d){
		if(error){
			throw error;
		}
		res.send(d);
		client.end();
	});

};

exports.fetchMachCondition = function(req, res){
	var uid = req.body.uid;
	var client = utility.prepareDb();
	var querystring = "select matchCondtion from d where personid = '" + uid +"'";
	console.log(querystring);
	client.query(querystring, function(error, d){
		if(error){
			throw error;
		}

		res.send(d);
		client.end();
	});
};

exports.newMatchCondition = function(reg,res){
    res.render("./cp/newMatchCondition.ejs",{title:"misMatch"});
}